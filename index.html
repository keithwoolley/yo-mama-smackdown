<html>
 <head>
  <title>Yo Mama Smackdown</title>
  <script src="https://cdn.firebase.com/js/client/2.0.4/firebase.js"></script>
  <script src='https://ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js'></script>
  <link rel="stylesheet" type="text/css" href="styles.css">
</head>
<body>
<!-- CHAT MARKUP -->
<div class="example-chat l-demo-container">
  <div class="header">
    <span class="logo"><img src="yomamalogo-1.jpg" alt="logo" style="width:100px;height:100px"></img></span>
    <h1>Yo Mama Smackdown</h1>
  </div>
  <div class='example-chat-toolbar'>
    <label for="nameInput">Yo Mama so:</label>
    <input type='text' id='nameInput' placeholder='enter an adjective...'>,
    <input type='text' id='messageInput'  placeholder='enter an insult...' size="60">
  </div>
  <ul id='example-messages' class="example-chat-messages"></ul> 
</div>
<div>
  <a id='randomLink' href="#">Random Joke</a>:
  <span id='randomJoke'>placeholder</span>
</div>


<!-- CHAT JAVACRIPT -->
<script>
  // CREATE A REFERENCE TO FIREBASE
  var messagesRef = new Firebase('https://amber-torch-8551.firebaseIO.com/');

  // REGISTER DOM ELEMENTS
  var messageField = $('#messageInput');
  var nameField = $('#nameInput');
  var messageList = $('#example-messages');
  var randomLink = $('#randomLink');
  var randomJoke = $('#randomJoke');

  //LISTEN FOR RANDOM LINK CLICK EVENT
  randomLink.click(function (e) {
    randomJoke.text(generateRandomJoke());
  });

  // LISTEN FOR KEYPRESS EVENT
  messageField.keypress(function (e) {
    if (e.keyCode == 13) {
      //FIELD VALUES
      var username = nameField.val();
      var message = messageField.val();

      //SAVE DATA TO FIREBASE AND EMPTY FIELD
      messagesRef.push({name:username, text:message});
      messageField.val('');
    }
  });

  // Add a callback that is triggered for each chat message.
  messagesRef.limitToLast(10).on('child_added', function (snapshot) {
    //GET DATA
    var data = snapshot.val();
    var username = data.name || "anonymous";
    var message = data.text;

    //CREATE ELEMENTS MESSAGE & SANITIZE TEXT
    var messageElement = $("<li>");
    var text = "Yo Mama so " + username + ", " + message;
    messageElement.text(text);

    //ADD MESSAGE
    messageList.append(messageElement)

    //SCROLL TO BOTTOM OF MESSAGE LIST
    messageList[0].scrollTop = messageList[0].scrollHeight;
  });

  var generateRandomJoke = function() {
    var jokes = [
      "Yo mama's so fat, I had to take a train and two buses just to get on her good side.",
      "Yo mama's so fat, when she turns around, people throw her a welcome back party. ",
      "Yo mama's so stupid, she got hit by a parked car.",
      "Yo mama's so stupid, she sold the car for gas money.",
      "Yo mama's so ugly, she scares away blind kids.",
      "Yo mama's so ugly, when she gets up, the sun goes down.",
      "Yo mama's so old, when she was in school there was no history class.",
      "Yo mama's so old, her birth certificate expired."
    ];
    var item = jokes[Math.floor(Math.random() * jokes.length)];
    return item;
  }
</script>
</body>
